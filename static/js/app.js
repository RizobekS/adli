(()=>{function V(){let e=document.getElementById("panelSidebar"),t=document.getElementById("panelSidebarToggle");if(!e||e.dataset.bound==="1")return;e.dataset.bound="1";let n="adli_sidebar_collapsed",s="w-72",o="w-20",i=()=>e.querySelectorAll(".sidebar-label"),c=0,l=null,q=()=>{i().forEach(d=>{d.classList.add("hidden"),d.classList.remove("opacity-100"),d.classList.add("opacity-0")})},v=()=>{i().forEach(d=>{d.classList.remove("hidden"),d.classList.remove("opacity-0"),d.classList.add("opacity-100")})};i().forEach(d=>d.classList.add("transition-opacity","duration-200"));let m=d=>{document.documentElement.style.setProperty("--sidebar-w",d?"5rem":"18rem"),document.documentElement.dataset.sidebarCollapsed=d?"1":"0"},f=d=>{e.classList.toggle(s,!d),e.classList.toggle(o,d)},h=()=>{l&&(clearTimeout(l),l=null)},g=()=>{c+=1;let d=c;h(),f(!1),m(!1);let S=A=>{A.propertyName==="width"&&(e.removeEventListener("transitionend",S),d===c&&v())};e.addEventListener("transitionend",S),l=setTimeout(()=>{d===c&&v()},320)},L=()=>{c+=1,h(),q(),f(!0),m(!0)},b=d=>{d?L():g()},w=localStorage.getItem(n)==="1";b(w),t&&!t.dataset.bound&&(t.dataset.bound="1",t.addEventListener("click",()=>{let S=!(localStorage.getItem(n)==="1");localStorage.setItem(n,S?"1":"0"),b(S)})),e.addEventListener("mouseenter",()=>{localStorage.getItem(n)==="1"&&g()}),e.addEventListener("mouseleave",()=>{localStorage.getItem(n)==="1"&&L()})}function Q(){let e=document.getElementById("panelMobileOpen"),t=document.getElementById("panelMobileClose"),n=document.getElementById("panelMobileSidebar"),s=document.getElementById("panelMobileBackdrop");if(!e||!t||!n||!s||e.dataset.bound==="1")return;e.dataset.bound="1";let o=!1,i=()=>{o||(o=!0,s.classList.remove("pointer-events-none"),n.classList.remove("pointer-events-none"),s.classList.remove("opacity-0"),s.classList.add("opacity-100"),n.classList.remove("-translate-x-full","opacity-0"),n.classList.add("translate-x-0","opacity-100"))},c=()=>{o&&(o=!1,s.classList.remove("opacity-100"),s.classList.add("opacity-0"),n.classList.remove("translate-x-0","opacity-100"),n.classList.add("-translate-x-full","opacity-0"),setTimeout(()=>{o||(s.classList.add("pointer-events-none"),n.classList.add("pointer-events-none"))},220))};n.dataset.closeFn="1",window.__adliCloseMobileSidebar=c,e.addEventListener("click",i),t.addEventListener("click",c),s.addEventListener("click",c),document.body.dataset.mobileEscBound||(document.body.dataset.mobileEscBound="1",document.addEventListener("keydown",l=>{l.key==="Escape"&&typeof window.__adliCloseMobileSidebar=="function"&&window.__adliCloseMobileSidebar()}))}function $(){let e=document.body.dataset.notSelected||"\u041D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D",t=document.getElementById("id_target_department"),n=document.getElementById("id_target_employee"),s=document.getElementById("depLabel"),o=document.getElementById("empLabel"),i=document.getElementById("empSearch"),c=document.getElementById("empList");if(!t||!n||!s||!o||!c)return;function l(m,f){m.value=f,m.dispatchEvent(new Event("change",{bubbles:!0}))}function q(m){c.querySelectorAll(".emp-item").forEach(f=>{let h=f.getAttribute("data-dep")||"";f.style.display=!m||h===m?"":"none"})}function v(m){let f=document.getElementById(m);f&&f.classList.add("hidden")}document.body.dataset.resDropBound||(document.body.dataset.resDropBound="1",document.addEventListener("click",m=>{let f=document.getElementById("depMenu"),h=document.getElementById("empMenu");f&&!m.target.closest("#depMenu")&&!m.target.closest("#depBtn")&&f.classList.add("hidden"),h&&!m.target.closest("#empMenu")&&!m.target.closest("#empBtn")&&h.classList.add("hidden");let g=m.target.closest("button[data-set]");if(!g)return;let L=g.dataset.set,b=g.dataset.id||"",w=g.dataset.label||"";if(L==="dep"){l(t,b),s.textContent=w||e,l(n,""),o.textContent=e,q(b),v("depMenu");return}if(L==="emp"){let d=t.value||"",S=g.dataset.dep||"";if(d&&S&&d!==S)return;l(n,b),o.textContent=w||e,v("empMenu")}},{capture:!0})),q(t.value||""),i&&i.dataset.bound!=="1"&&(i.dataset.bound="1",i.addEventListener("input",()=>{let m=i.value.trim().toLowerCase();c.querySelectorAll(".emp-item").forEach(f=>{let h=f.getAttribute("data-name")||"";f.style.display=h.includes(m)?"":"none"})}))}function te(){document.addEventListener("click",e=>{let t=e.target.closest("[data-dep-asst-id]");if(!t)return;let n=t.closest("form");if(!n)return;let s=n.querySelector("#depAsstInput"),o=n.querySelector("#depAsstLabel"),i=n.querySelector("#depAsstMenu");s&&(s.value=t.dataset.depAsstId||""),o&&(o.textContent=t.dataset.depAsstLabel||"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435..."),i&&i.classList.add("hidden"),e.preventDefault(),e.stopPropagation()})}document.addEventListener("DOMContentLoaded",()=>{te()});function P(){document.querySelectorAll('input[type="date"]').forEach(e=>{if(e.dataset.dateBound==="1")return;e.dataset.dateBound="1";let t=0,n=()=>{let s=Date.now();s-t<180||(t=s,typeof e.showPicker=="function"?e.showPicker():e.focus())};e.addEventListener("click",n),e.addEventListener("focus",n)})}function W(){let e=document.getElementById("toast-stack");if(!e)return;let t=e.querySelectorAll(".adli-toast:not([data-init='1'])");function n(o){requestAnimationFrame(()=>{o.classList.remove("opacity-0","translate-x-8"),o.classList.add("opacity-100","translate-x-0")})}function s(o){o.classList.remove("opacity-100","translate-x-0"),o.classList.add("opacity-0","translate-x-8"),setTimeout(()=>o.remove(),320)}t.forEach(o=>{o.dataset.init="1",n(o);let i=o.querySelector(".adli-toast-close");i&&!i.dataset.bound&&(i.dataset.bound="1",i.addEventListener("click",()=>s(o)));let c=parseInt(o.dataset.delay||"4500",10);setTimeout(()=>s(o),c)})}function D(e,t=""){return window.DASH_I18N&&window.DASH_I18N[e]||t}function Y(e){let t=e?.values||[];return t.length?t.every(n=>!n||Number(n)===0):!0}function ne(e,t){let n=document.getElementById(e);if(n){try{let s=echarts.getInstanceByDom(n);s&&s.dispose()}catch{}n.innerHTML=`
    <div class="h-full w-full flex items-center justify-center text-sm text-gray-500">
      ${t}
    </div>
  `}}function se(e,t){let n=document.querySelector(`[data-chart-error="${e}"]`);n&&(n.textContent=t,n.classList.remove("hidden"))}function ie(e){let t=document.querySelector(`[data-chart-error="${e}"]`);t&&(t.classList.add("hidden"),t.textContent="")}function oe(e){e.querySelectorAll(".dash-card").forEach((n,s)=>{n.style.opacity="0",n.style.transform="translateY(8px)",n.style.transition="opacity 260ms ease, transform 260ms ease",setTimeout(()=>{n.style.opacity="1",n.style.transform="translateY(0)"},40+s*40)})}function R(e){let t=document.getElementById(e);if(!t)return null;try{let n=echarts.getInstanceByDom(t);n&&n.dispose()}catch{}return echarts.init(t)}function ae(e){let t=()=>{e.forEach(n=>n&&n.resize())};if(window.addEventListener("resize",t),window.ResizeObserver){let n=new ResizeObserver(()=>t());e.forEach(s=>{s&&n.observe(s.getDom())})}}function re(e){if(!e)return;let t=(n,s)=>{let o=document.getElementById(n);o&&(o.textContent=s??"0")};t("kpiRequestsTotal",e.requests?.total),t("kpiRequestsNew",e.requests?.new),t("kpiRequestsInProgress",e.requests?.in_progress),t("kpiRequestsOverdue",e.requests?.overdue),t("kpiRequestsDoneToday",e.requests?.done_today),t("kpiCompaniesTotal",e.companies?.total),t("kpiCompaniesWithRegion",e.companies?.with_region),t("kpiCompaniesWithoutRegion",e.companies?.without_region),t("kpiCompaniesWithoutCategory",e.companies?.without_category),t("kpiCompaniesWithoutDirections",e.companies?.without_directions)}function ce(e,t){let n=R(e);if(!n)return null;let s=t?.series||[];return n.setOption({tooltip:{trigger:"item"},legend:{top:"bottom"},series:[{name:"status",type:"pie",radius:["45%","70%"],avoidLabelOverlap:!0,itemStyle:{borderRadius:6,borderColor:"#fff",borderWidth:2},label:{show:!1},emphasis:{label:{show:!0,fontSize:12,fontWeight:"bold"}},labelLine:{show:!1},data:s,animationDuration:700,animationEasing:"cubicOut"}]}),n}function de(e,t,n){let s=R(e);return s?(s.setOption({tooltip:{trigger:"item"},legend:{top:"bottom"},series:[{name:t,type:"pie",radius:["40%","70%"],avoidLabelOverlap:!0,itemStyle:{borderRadius:6,borderColor:"#fff",borderWidth:2},label:{show:!1},emphasis:{label:{show:!0,fontSize:12,fontWeight:"bold"}},labelLine:{show:!1},data:n,animationDuration:700,animationEasing:"cubicOut"}]}),s):null}function K(e,t,n={}){let s=R(e);if(!s)return null;let o=t?.labels||[],i=t?.values||[];return s.setOption({tooltip:{trigger:"axis"},grid:{left:24,right:16,top:16,bottom:48,containLabel:!0},xAxis:{type:"category",data:o,axisLabel:{rotate:n.rotateLabels?25:0}},yAxis:{type:"value"},series:[{type:"bar",data:i,animationDuration:700,animationEasing:"cubicOut"}]}),s}function T(e,t){let n=R(e);if(!n)return null;let s=t?.labels||[],o=t?.values||[];return n.setOption({tooltip:{trigger:"axis"},grid:{left:24,right:16,top:16,bottom:16,containLabel:!0},xAxis:{type:"value"},yAxis:{type:"category",data:s,axisLabel:{width:200,overflow:"break",lineHeight:14}},series:[{type:"bar",data:o,animationDuration:700,animationEasing:"cubicOut"}]}),n}function le(e,t,n){let s=R(e);if(!s)return null;let o=t?.labels||[],i=t?.values||[],c=n?.values||[];return s.setOption({tooltip:{trigger:"axis"},legend:{top:8},grid:{left:24,right:16,top:36,bottom:48,containLabel:!0},xAxis:{type:"category",data:o},yAxis:{type:"value"},series:[{name:D("created","\u0421\u043E\u0437\u0434\u0430\u043D\u043E"),type:"line",data:i,smooth:!0,animationDuration:700,animationEasing:"cubicOut"},{name:D("closed","\u0417\u0430\u043A\u0440\u044B\u0442\u043E"),type:"line",data:c,smooth:!0,animationDuration:700,animationEasing:"cubicOut"}]}),s}async function ue(e){let t=await fetch(e,{headers:{"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"});if(!t.ok)throw new Error(`HTTP ${t.status}`);return await t.json()}function z(){let e=document.getElementById("dashboardRoot");if(!e)return;let t=e.dataset.dashboardUrl;if(!t)return;let n=document.getElementById("dashboardRefreshBtn"),s=[],o=async()=>{try{let i=await ue(t);re(i.kpi),Y(i.sla_overdue_by_department)?ne("chartSlaOverdueDepartments",D("no_overdue","\u041F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u043D\u044B\u0445 \u0437\u0430\u044F\u0432\u043E\u043A \u043D\u0435\u0442")):T("chartSlaOverdueDepartments",i.sla_overdue_by_department),["chartRequestsStatus","chartRequestsDirections","chartRequestsRegions","chartRequestsTimeline","chartSlaOverdueDepartments","chartCompaniesCategories","chartCompaniesRegions","chartDataQuality"].forEach(ie);let c=ce("chartRequestsStatus",i.requests_by_status),l=K("chartRequestsDirections",i.requests_by_direction,{rotateLabels:!0}),q=T("chartRequestsRegions",i.requests_by_region),v=le("chartRequestsTimeline",i.requests_timeline_created,i.requests_timeline_done),m=Y(i.sla_overdue_by_department)?null:T("chartSlaOverdueDepartments",i.sla_overdue_by_department),f=K("chartCompaniesCategories",i.companies_by_category,{rotateLabels:!0}),h=T("chartCompaniesRegions",i.companies_by_region),g=i.data_quality||{},L=g.total||0,b=Math.max(0,L-(g.missing_region||0)-(g.missing_district||0)-(g.missing_category||0)),w=[{name:D("dq_no_region","\u0411\u0435\u0437 \u0440\u0435\u0433\u0438\u043E\u043D\u0430"),value:g.missing_region||0},{name:D("dq_no_district","\u0411\u0435\u0437 \u0440\u0430\u0439\u043E\u043D\u0430"),value:g.missing_district||0},{name:D("dq_no_category","\u0411\u0435\u0437 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438"),value:g.missing_category||0},{name:D("dq_no_directions","\u0411\u0435\u0437 \u043D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0439"),value:g.missing_directions||0}],d=de("chartDataQuality",D("dq_title","\u041A\u0430\u0447\u0435\u0441\u0442\u0432\u043E \u0434\u0430\u043D\u043D\u044B\u0445"),w);s=[c,l,q,v,m,f,h,d].filter(Boolean),ae(s),oe(e)}catch(i){let c="\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0430\u043D\u0430\u043B\u0438\u0442\u0438\u043A\u0443.";["chartRequestsStatus","chartRequestsDirections","chartRequestsRegions","chartRequestsTimeline","chartSlaOverdueDepartments","chartCompaniesCategories","chartCompaniesRegions","chartDataQuality"].forEach(l=>se(l,c)),console.error("[dashboard] load failed:",i)}};n&&n.addEventListener("click",o),o()}function N(){let e=document.querySelector('form[data-public-request-form="1"]');if(!e)return;let t=document.getElementById("id_category"),n=document.getElementById("id_region"),s=document.getElementById("id_district"),o=document.getElementById("id_directions");if(!t||!n||!s||!o)return;let i=document.getElementById("reqRegionLabel"),c=document.getElementById("reqDistrictBtn"),l=document.getElementById("reqDistrictLabel"),q=document.getElementById("reqDistrictHint"),v=document.getElementById("reqDistrictList"),m=document.getElementById("reqDistrictSearch"),f=document.getElementById("reqCategoryLabel"),h=document.getElementById("reqDirectionsBtn"),g=document.getElementById("reqDirectionsLabel"),L=document.getElementById("reqDirectionsMenu"),b=document.getElementById("reqDirectionsList"),w=document.getElementById("reqDirectionsSearch"),d=document.getElementById("reqDirectionsHint"),S=document.getElementById("reqDirectionsChips"),A=document.getElementById("reqDirectionsClear"),X=document.getElementById("reqDirectionsDone"),G=e.dataset.districtsUrl,J=e.dataset.directionsUrl;function C(a){return String(a??"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function _(a){let r=document.getElementById(a);r&&r.classList.add("hidden")}function Z(){document.querySelectorAll("[data-dropdown-toggle]").forEach(a=>{let r=a.getAttribute("data-dropdown-toggle");r&&_(r)}),L&&L.classList.add("hidden")}document.addEventListener("keydown",a=>{a.key==="Escape"&&Z()});async function j(a){if(v.innerHTML="",!a){c.disabled=!0,v.innerHTML='<li class="px-3 py-2 text-gray-500">\u0421\u043D\u0430\u0447\u0430\u043B\u0430 \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0435\u0433\u0438\u043E\u043D</li>';return}c.disabled=!1,q&&q.classList.add("hidden"),v.innerHTML='<li class="px-3 py-2 text-gray-500">\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430...</li>';let r=`${G}?region_id=${encodeURIComponent(a)}`,x=(await(await fetch(r,{headers:{"X-Requested-With":"XMLHttpRequest"}})).json()).results||[];s.innerHTML="";let p=document.createElement("option");if(p.value="",p.textContent="\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0430\u0439\u043E\u043D/\u0433\u043E\u0440\u043E\u0434",s.appendChild(p),x.forEach(E=>{let I=document.createElement("option");I.value=String(E.id),I.textContent=E.name,s.appendChild(I)}),!x.length){v.innerHTML='<li class="px-3 py-2 text-gray-500">\u041D\u0435\u0442 \u0440\u0430\u0439\u043E\u043D\u043E\u0432</li>';return}v.innerHTML=`<li>
        <button type="button" class="w-full px-3 py-2 text-left hover:bg-gray-50"
                data-set="req-district" data-id="" data-label="\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0430\u0439\u043E\u043D/\u0433\u043E\u0440\u043E\u0434">
          \u041D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D\u043E
        </button>
      </li>`+x.map(E=>`
          <li class="req-district-item" data-name="${C((E.name||"").toLowerCase())}">
            <button type="button" class="w-full px-3 py-2 text-left hover:bg-gray-50"
                    data-set="req-district" data-id="${E.id}" data-label="${C(E.name)}">
              ${C(E.name)}
            </button>
          </li>`).join("")}c&&c.addEventListener("click",a=>{n.value||(a.preventDefault(),q&&(q.classList.remove("hidden"),setTimeout(()=>q.classList.add("hidden"),2500)),_("reqDistrictMenu"))}),m&&m.addEventListener("input",()=>{let a=m.value.trim().toLowerCase();v.querySelectorAll(".req-district-item").forEach(r=>{let u=r.dataset.name||"";r.style.display=u.includes(a)?"":"none"})});function B(){return Array.from(o.selectedOptions).map(a=>a.value)}function F(){if(!b)return;let a=new Set(B().map(String));b.querySelectorAll("input[data-dir-id]").forEach(r=>{let u=r.getAttribute("data-dir-id");r.checked=a.has(String(u))})}function O(a){let r=new Set(a.map(String));Array.from(o.options).forEach(u=>{u.selected=r.has(u.value)}),o.dispatchEvent(new Event("change",{bubbles:!0})),k(),M(),F()}function M(){let a=B();if(!a.length){g.textContent="\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u044F";return}g.textContent=`\u0412\u044B\u0431\u0440\u0430\u043D\u043E: ${a.length}`}function k(){S.innerHTML="",Array.from(o.selectedOptions).map(r=>({id:r.value,title:r.textContent})).forEach(r=>{let u=document.createElement("button");u.type="button",u.className="inline-flex items-center gap-2 rounded-full border border-blue-200 bg-blue-50 px-3 py-1 text-sm text-blue-800 hover:bg-blue-100",u.innerHTML=`<span>${C(r.title)}</span><span class="text-blue-600">\u2715</span>`,u.addEventListener("click",()=>{let y=B().filter(x=>x!==String(r.id));O(y)}),S.appendChild(u)})}function ee(a){let r=new Set(B());o.innerHTML="",a.forEach(p=>{let E=document.createElement("option");E.value=String(p.id),E.textContent=p.title,o.appendChild(E)});let u=new Set(a.map(p=>String(p.id)));if(Array.from(r).filter(p=>u.has(String(p))).forEach(p=>{let E=Array.from(o.options).find(I=>I.value===String(p));E&&(E.selected=!0)}),!a.length){b.innerHTML='<li class="px-3 py-2 text-gray-500">\u041D\u0435\u0442 \u043D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0439</li>',k(),M(),F();return}let x=new Set(B());b.innerHTML=a.map(p=>`
        <li class="direction-item" data-name="${C((p.title||"").toLowerCase())}">
          <label class="flex items-center gap-3 px-3 py-2 hover:bg-gray-50 cursor-pointer">
            <input type="checkbox" class="h-4 w-4" data-dir-id="${p.id}" ${x.has(String(p.id))?"checked":""}>
            <span class="text-sm text-gray-800">${C(p.title)}</span>
          </label>
        </li>`).join(""),k(),M()}async function H(a){if(!a){h.disabled=!0,b.innerHTML='<li class="px-3 py-2 text-gray-500">\u0421\u043D\u0430\u0447\u0430\u043B\u0430 \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044E</li>',o.innerHTML="",k(),M();return}h.disabled=!1,d&&d.classList.add("hidden"),b.innerHTML='<li class="px-3 py-2 text-gray-500">\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430...</li>';let r=`${J}?category=${encodeURIComponent(a)}`,y=await(await fetch(r,{headers:{"X-Requested-With":"XMLHttpRequest"}})).json();ee(y.results||[])}h&&h.addEventListener("click",a=>{if(h.disabled){a.preventDefault(),d&&(d.classList.remove("hidden"),setTimeout(()=>d.classList.add("hidden"),2500)),L.classList.add("hidden");return}L.classList.toggle("hidden")}),w&&w.addEventListener("input",()=>{let a=w.value.trim().toLowerCase();b.querySelectorAll(".direction-item").forEach(r=>{let u=r.dataset.name||"";r.style.display=u.includes(a)?"":"none"})}),A&&A.addEventListener("click",()=>O([])),X&&X.addEventListener("click",()=>L.classList.add("hidden")),document.addEventListener("click",a=>{let r=a.target.closest("input[data-dir-id]");if(r){let u=r.getAttribute("data-dir-id"),y=new Set(B());r.checked?y.add(String(u)):y.delete(String(u)),O(Array.from(y));return}}),document.addEventListener("click",async a=>{let r=a.target.closest("button[data-set]");if(!r)return;let u=r.dataset.set,y=r.dataset.id||"",x=r.dataset.label||"";if(u==="req-region"){n.value=y,i&&(i.textContent=x||"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0435\u0433\u0438\u043E\u043D"),s.value="",l&&(l.textContent="\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0430\u0439\u043E\u043D/\u0433\u043E\u0440\u043E\u0434"),await j(y),n.dispatchEvent(new Event("change",{bubbles:!0})),_("reqRegionMenu");return}if(u==="req-district"){if(y&&!Array.from(s.options).some(p=>p.value===String(y))){let p=document.createElement("option");p.value=String(y),p.textContent=x,s.appendChild(p)}s.value=String(y),l&&(l.textContent=x||"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0430\u0439\u043E\u043D/\u0433\u043E\u0440\u043E\u0434"),s.dispatchEvent(new Event("change",{bubbles:!0})),_("reqDistrictMenu");return}if(u==="req-category"){t.value=y,f&&(f.textContent=x||"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044E"),t.dispatchEvent(new Event("change",{bubbles:!0})),_("reqCategoryMenu"),await H(y);return}}),document.addEventListener("click",a=>{!a.target.closest("#reqDirectionsMenu")&&!a.target.closest("#reqDirectionsBtn")&&L?.classList.add("hidden")}),n.value&&j(n.value),t.value?H(t.value):H("")}function U(){let e=document.getElementById("attachments-container"),t=document.getElementById("add-attachment");if(!e||!t)return;function n(i){i.addEventListener("click",()=>{i.closest(".flex")?.remove(),s()})}function s(){let i=e.querySelectorAll(".flex");if(!i.length)return;let c=i[0].querySelector(".remove-attachment");c&&(i.length===1?c.classList.add("hidden"):c.classList.remove("hidden"))}let o=e.querySelector(".remove-attachment");o&&n(o),t.addEventListener("click",()=>{let i=document.createElement("div");i.className="flex gap-2";let c=document.createElement("input");c.type="file",c.name="attachments",c.accept=".pdf,.doc,.docx,.xls,.xlsx",c.className="block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer p-2 bg-gray-50";let l=document.createElement("button");l.type="button",l.className="remove-attachment shrink-0 rounded-lg border border-gray-300 bg-white px-3 text-sm hover:bg-gray-50",l.textContent="\u2715",n(l),i.appendChild(c),i.appendChild(l),e.appendChild(i),s()}),s()}function me(){V(),Q(),$(),P(),W(),z(),N(),U()}document.addEventListener("DOMContentLoaded",me);document.body.addEventListener("htmx:afterSwap",()=>{$(),P(),W(),z(),N(),U()});})();
