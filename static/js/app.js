(()=>{function K(){let e=document.getElementById("panelSidebar"),n=document.getElementById("panelSidebarToggle");if(!e||e.dataset.bound==="1")return;e.dataset.bound="1";let t="adli_sidebar_collapsed",s="w-72",i="w-20",o=()=>e.querySelectorAll(".sidebar-label"),c=0,p=null,E=()=>{o().forEach(l=>{l.classList.add("hidden"),l.classList.remove("opacity-100"),l.classList.add("opacity-0")})},b=()=>{o().forEach(l=>{l.classList.remove("hidden"),l.classList.remove("opacity-0"),l.classList.add("opacity-100")})};o().forEach(l=>l.classList.add("transition-opacity","duration-200"));let w=l=>{document.documentElement.style.setProperty("--sidebar-w",l?"5rem":"18rem"),document.documentElement.dataset.sidebarCollapsed=l?"1":"0"},B=l=>{e.classList.toggle(s,!l),e.classList.toggle(i,l)},h=()=>{p&&(clearTimeout(p),p=null)},g=()=>{c+=1;let l=c;h(),B(!1),w(!1);let d=u=>{u.propertyName==="width"&&(e.removeEventListener("transitionend",d),l===c&&b())};e.addEventListener("transitionend",d),p=setTimeout(()=>{l===c&&b()},320)},S=()=>{c+=1,h(),E(),B(!0),w(!0)},v=l=>{l?S():g()},D=localStorage.getItem(t)==="1";v(D),n&&!n.dataset.bound&&(n.dataset.bound="1",n.addEventListener("click",()=>{let d=!(localStorage.getItem(t)==="1");localStorage.setItem(t,d?"1":"0"),v(d)})),e.addEventListener("mouseenter",()=>{localStorage.getItem(t)==="1"&&g()}),e.addEventListener("mouseleave",()=>{localStorage.getItem(t)==="1"&&S()})}function G(){let e=document.getElementById("panelMobileOpen"),n=document.getElementById("panelMobileClose"),t=document.getElementById("panelMobileSidebar"),s=document.getElementById("panelMobileBackdrop");if(!e||!n||!t||!s||e.dataset.bound==="1")return;e.dataset.bound="1";let i=!1,o=()=>{i||(i=!0,s.classList.remove("pointer-events-none"),t.classList.remove("pointer-events-none"),s.classList.remove("opacity-0"),s.classList.add("opacity-100"),t.classList.remove("-translate-x-full","opacity-0"),t.classList.add("translate-x-0","opacity-100"))},c=()=>{i&&(i=!1,s.classList.remove("opacity-100"),s.classList.add("opacity-0"),t.classList.remove("translate-x-0","opacity-100"),t.classList.add("-translate-x-full","opacity-0"),setTimeout(()=>{i||(s.classList.add("pointer-events-none"),t.classList.add("pointer-events-none"))},220))};t.dataset.closeFn="1",window.__adliCloseMobileSidebar=c,e.addEventListener("click",o),n.addEventListener("click",c),s.addEventListener("click",c),document.body.dataset.mobileEscBound||(document.body.dataset.mobileEscBound="1",document.addEventListener("keydown",p=>{p.key==="Escape"&&typeof window.__adliCloseMobileSidebar=="function"&&window.__adliCloseMobileSidebar()}))}function F(){let e=document.body.dataset.notSelected||"\u041D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D",n=document.getElementById("depAsstInput"),t=document.getElementById("depAsstSearch"),s=document.getElementById("depAsstList"),i=document.getElementById("sendForResolutionBtn");function o(){i&&(i.disabled=!(n&&n.value))}function c(){s&&s.querySelectorAll(".dep-asst-check").forEach(d=>d.classList.add("hidden"))}function p(d){c();let u=d.querySelector(".dep-asst-check");u&&u.classList.remove("hidden")}s&&s.dataset.bound!=="1"&&(s.dataset.bound="1",s.addEventListener("click",d=>{let u=d.target.closest("[data-dep-asst-id]");if(!u)return;let q=u.dataset.depAsstId||"";n&&(n.value=q),p(u),o(),d.preventDefault(),d.stopPropagation()})),t&&t.dataset.bound!=="1"&&(t.dataset.bound="1",t.addEventListener("input",()=>{let d=t.value.trim().toLowerCase();s?.querySelectorAll(".dep-asst-item").forEach(u=>{let q=u.getAttribute("data-name")||"";u.style.display=q.includes(d)?"":"none"})})),o();let E=document.getElementById("id_target_department"),b=document.getElementById("id_target_employee"),w=document.getElementById("depLabel"),B=document.getElementById("empLabel"),h=document.getElementById("empSearch"),g=document.getElementById("empList");if(!!!(E&&b&&w&&B&&g))return;function v(d,u){d.value=u,d.dispatchEvent(new Event("change",{bubbles:!0}))}function D(d){g.querySelectorAll(".emp-item").forEach(u=>{let q=u.getAttribute("data-dep")||"";u.style.display=!d||q===d?"":"none"})}function l(d){let u=document.getElementById(d);u&&u.classList.add("hidden")}document.body.dataset.resDropBound||(document.body.dataset.resDropBound="1",document.addEventListener("click",d=>{let u=document.getElementById("depMenu"),q=document.getElementById("empMenu");u&&!d.target.closest("#depMenu")&&!d.target.closest("#depBtn")&&u.classList.add("hidden"),q&&!d.target.closest("#empMenu")&&!d.target.closest("#empBtn")&&q.classList.add("hidden");let A=d.target.closest("button[data-set]");if(!A)return;let O=A.dataset.set,C=A.dataset.id||"",_=A.dataset.label||"";if(O==="dep"){v(E,C),w.textContent=_||e,v(b,""),B.textContent=e,D(C),l("depMenu");return}if(O==="emp"){let H=E.value||"",k=A.dataset.dep||"";if(H&&k&&H!==k)return;v(b,C),B.textContent=_||e,l("empMenu")}},{capture:!0})),D(E.value||""),h&&h.dataset.bound!=="1"&&(h.dataset.bound="1",h.addEventListener("input",()=>{let d=h.value.trim().toLowerCase();g.querySelectorAll(".emp-item").forEach(u=>{let q=u.getAttribute("data-name")||"";u.style.display=q.includes(d)?"":"none"})}))}function U(){document.querySelectorAll('input[type="date"]').forEach(e=>{if(e.dataset.dateBound==="1")return;e.dataset.dateBound="1";let n=0,t=()=>{let s=Date.now();s-n<180||(n=s,typeof e.showPicker=="function"?e.showPicker():e.focus())};e.addEventListener("click",t),e.addEventListener("focus",t)})}function X(){let e=document.getElementById("toast-stack");if(!e)return;let n=e.querySelectorAll(".adli-toast:not([data-init='1'])");function t(i){requestAnimationFrame(()=>{i.classList.remove("opacity-0","translate-x-8"),i.classList.add("opacity-100","translate-x-0")})}function s(i){i.classList.remove("opacity-100","translate-x-0"),i.classList.add("opacity-0","translate-x-8"),setTimeout(()=>i.remove(),320)}n.forEach(i=>{i.dataset.init="1",t(i);let o=i.querySelector(".adli-toast-close");o&&!o.dataset.bound&&(o.dataset.bound="1",o.addEventListener("click",()=>s(i)));let c=parseInt(i.dataset.delay||"4500",10);setTimeout(()=>s(i),c)})}function I(e,n=""){return window.DASH_I18N&&window.DASH_I18N[e]||n}function J(e){let n=e?.values||[];return n.length?n.every(t=>!t||Number(t)===0):!0}function te(e,n){let t=document.getElementById(e);if(t){try{let s=echarts.getInstanceByDom(t);s&&s.dispose()}catch{}t.innerHTML=`
    <div class="h-full w-full flex items-center justify-center text-sm text-gray-500">
      ${n}
    </div>
  `}}function ne(e,n){let t=document.querySelector(`[data-chart-error="${e}"]`);t&&(t.textContent=n,t.classList.remove("hidden"))}function se(e){let n=document.querySelector(`[data-chart-error="${e}"]`);n&&(n.classList.add("hidden"),n.textContent="")}function ie(e){e.querySelectorAll(".dash-card").forEach((t,s)=>{t.style.opacity="0",t.style.transform="translateY(8px)",t.style.transition="opacity 260ms ease, transform 260ms ease",setTimeout(()=>{t.style.opacity="1",t.style.transform="translateY(0)"},40+s*40)})}function T(e){let n=document.getElementById(e);if(!n)return null;try{let t=echarts.getInstanceByDom(n);t&&t.dispose()}catch{}return echarts.init(n)}function oe(e){let n=()=>{e.forEach(t=>t&&t.resize())};if(window.addEventListener("resize",n),window.ResizeObserver){let t=new ResizeObserver(()=>n());e.forEach(s=>{s&&t.observe(s.getDom())})}}function ae(e){if(!e)return;let n=(t,s)=>{let i=document.getElementById(t);i&&(i.textContent=s??"0")};n("kpiRequestsTotal",e.requests?.total),n("kpiRequestsNew",e.requests?.new),n("kpiRequestsInProgress",e.requests?.in_progress),n("kpiRequestsOverdue",e.requests?.overdue),n("kpiRequestsDoneToday",e.requests?.done_today),n("kpiCompaniesTotal",e.companies?.total),n("kpiCompaniesWithRegion",e.companies?.with_region),n("kpiCompaniesWithoutRegion",e.companies?.without_region),n("kpiCompaniesWithoutCategory",e.companies?.without_category),n("kpiCompaniesWithoutDirections",e.companies?.without_directions)}function re(e,n){let t=T(e);if(!t)return null;let s=n?.series||[];return t.setOption({tooltip:{trigger:"item"},legend:{top:"bottom"},series:[{name:"status",type:"pie",radius:["45%","70%"],avoidLabelOverlap:!0,itemStyle:{borderRadius:6,borderColor:"#fff",borderWidth:2},label:{show:!1},emphasis:{label:{show:!0,fontSize:12,fontWeight:"bold"}},labelLine:{show:!1},data:s,animationDuration:700,animationEasing:"cubicOut"}]}),t}function ce(e,n,t){let s=T(e);return s?(s.setOption({tooltip:{trigger:"item"},legend:{top:"bottom"},series:[{name:n,type:"pie",radius:["40%","70%"],avoidLabelOverlap:!0,itemStyle:{borderRadius:6,borderColor:"#fff",borderWidth:2},label:{show:!1},emphasis:{label:{show:!0,fontSize:12,fontWeight:"bold"}},labelLine:{show:!1},data:t,animationDuration:700,animationEasing:"cubicOut"}]}),s):null}function Z(e,n,t={}){let s=T(e);if(!s)return null;let i=n?.labels||[],o=n?.values||[];return s.setOption({tooltip:{trigger:"axis"},grid:{left:24,right:16,top:16,bottom:48,containLabel:!0},xAxis:{type:"category",data:i,axisLabel:{rotate:t.rotateLabels?25:0}},yAxis:{type:"value"},series:[{type:"bar",data:o,animationDuration:700,animationEasing:"cubicOut"}]}),s}function W(e,n){let t=T(e);if(!t)return null;let s=n?.labels||[],i=n?.values||[];return t.setOption({tooltip:{trigger:"axis"},grid:{left:24,right:16,top:16,bottom:16,containLabel:!0},xAxis:{type:"value"},yAxis:{type:"category",data:s,axisLabel:{width:200,overflow:"break",lineHeight:14}},series:[{type:"bar",data:i,animationDuration:700,animationEasing:"cubicOut"}]}),t}function de(e,n,t){let s=T(e);if(!s)return null;let i=n?.labels||[],o=n?.values||[],c=t?.values||[];return s.setOption({tooltip:{trigger:"axis"},legend:{top:8},grid:{left:24,right:16,top:36,bottom:48,containLabel:!0},xAxis:{type:"category",data:i},yAxis:{type:"value"},series:[{name:I("created","\u0421\u043E\u0437\u0434\u0430\u043D\u043E"),type:"line",data:o,smooth:!0,animationDuration:700,animationEasing:"cubicOut"},{name:I("closed","\u0417\u0430\u043A\u0440\u044B\u0442\u043E"),type:"line",data:c,smooth:!0,animationDuration:700,animationEasing:"cubicOut"}]}),s}async function le(e){let n=await fetch(e,{headers:{"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"});if(!n.ok)throw new Error(`HTTP ${n.status}`);return await n.json()}function j(){let e=document.getElementById("dashboardRoot");if(!e)return;let n=e.dataset.dashboardUrl;if(!n)return;let t=document.getElementById("dashboardRefreshBtn"),s=[],i=async()=>{try{let o=await le(n);ae(o.kpi),J(o.sla_overdue_by_department)?te("chartSlaOverdueDepartments",I("no_overdue","\u041F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u043D\u044B\u0445 \u0437\u0430\u044F\u0432\u043E\u043A \u043D\u0435\u0442")):W("chartSlaOverdueDepartments",o.sla_overdue_by_department),["chartRequestsStatus","chartRequestsDirections","chartRequestsRegions","chartRequestsTimeline","chartSlaOverdueDepartments","chartCompaniesCategories","chartCompaniesRegions","chartDataQuality"].forEach(se);let c=re("chartRequestsStatus",o.requests_by_status),p=Z("chartRequestsDirections",o.requests_by_direction,{rotateLabels:!0}),E=W("chartRequestsRegions",o.requests_by_region),b=de("chartRequestsTimeline",o.requests_timeline_created,o.requests_timeline_done),w=J(o.sla_overdue_by_department)?null:W("chartSlaOverdueDepartments",o.sla_overdue_by_department),B=Z("chartCompaniesCategories",o.companies_by_category,{rotateLabels:!0}),h=W("chartCompaniesRegions",o.companies_by_region),g=o.data_quality||{},S=g.total||0,v=Math.max(0,S-(g.missing_region||0)-(g.missing_district||0)-(g.missing_category||0)),D=[{name:I("dq_no_region","\u0411\u0435\u0437 \u0440\u0435\u0433\u0438\u043E\u043D\u0430"),value:g.missing_region||0},{name:I("dq_no_district","\u0411\u0435\u0437 \u0440\u0430\u0439\u043E\u043D\u0430"),value:g.missing_district||0},{name:I("dq_no_category","\u0411\u0435\u0437 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438"),value:g.missing_category||0},{name:I("dq_no_directions","\u0411\u0435\u0437 \u043D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0439"),value:g.missing_directions||0}],l=ce("chartDataQuality",I("dq_title","\u041A\u0430\u0447\u0435\u0441\u0442\u0432\u043E \u0434\u0430\u043D\u043D\u044B\u0445"),D);s=[c,p,E,b,w,B,h,l].filter(Boolean),oe(s),ie(e)}catch(o){let c="\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0430\u043D\u0430\u043B\u0438\u0442\u0438\u043A\u0443.";["chartRequestsStatus","chartRequestsDirections","chartRequestsRegions","chartRequestsTimeline","chartSlaOverdueDepartments","chartCompaniesCategories","chartCompaniesRegions","chartDataQuality"].forEach(p=>ne(p,c)),console.error("[dashboard] load failed:",o)}};t&&t.addEventListener("click",i),i()}function V(){let e=document.querySelector('form[data-public-request-form="1"]');if(!e)return;let n=document.getElementById("id_category"),t=document.getElementById("id_region"),s=document.getElementById("id_district"),i=document.getElementById("id_directions");if(!n||!t||!s||!i)return;let o=document.getElementById("reqRegionLabel"),c=document.getElementById("reqDistrictBtn"),p=document.getElementById("reqDistrictLabel"),E=document.getElementById("reqDistrictHint"),b=document.getElementById("reqDistrictList"),w=document.getElementById("reqDistrictSearch"),B=document.getElementById("reqCategoryLabel"),h=document.getElementById("reqDirectionsBtn"),g=document.getElementById("reqDirectionsLabel"),S=document.getElementById("reqDirectionsMenu"),v=document.getElementById("reqDirectionsList"),D=document.getElementById("reqDirectionsSearch"),l=document.getElementById("reqDirectionsHint"),d=document.getElementById("reqDirectionsChips"),u=document.getElementById("reqDirectionsClear"),q=document.getElementById("reqDirectionsDone"),A=e.dataset.districtsUrl,O=e.dataset.directionsUrl;function C(a){return String(a??"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function _(a){let r=document.getElementById(a);r&&r.classList.add("hidden")}function H(){document.querySelectorAll("[data-dropdown-toggle]").forEach(a=>{let r=a.getAttribute("data-dropdown-toggle");r&&_(r)}),S&&S.classList.add("hidden")}document.addEventListener("keydown",a=>{a.key==="Escape"&&H()});async function k(a){if(b.innerHTML="",!a){c.disabled=!0,b.innerHTML='<li class="px-3 py-2 text-gray-500">\u0421\u043D\u0430\u0447\u0430\u043B\u0430 \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0435\u0433\u0438\u043E\u043D</li>';return}c.disabled=!1,E&&E.classList.add("hidden"),b.innerHTML='<li class="px-3 py-2 text-gray-500">\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430...</li>';let r=`${A}?region_id=${encodeURIComponent(a)}`,x=(await(await fetch(r,{headers:{"X-Requested-With":"XMLHttpRequest"}})).json()).results||[];s.innerHTML="";let f=document.createElement("option");if(f.value="",f.textContent="\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0430\u0439\u043E\u043D/\u0433\u043E\u0440\u043E\u0434",s.appendChild(f),x.forEach(L=>{let M=document.createElement("option");M.value=String(L.id),M.textContent=L.name,s.appendChild(M)}),!x.length){b.innerHTML='<li class="px-3 py-2 text-gray-500">\u041D\u0435\u0442 \u0440\u0430\u0439\u043E\u043D\u043E\u0432</li>';return}b.innerHTML=`<li>
        <button type="button" class="w-full px-3 py-2 text-left hover:bg-gray-50"
                data-set="req-district" data-id="" data-label="\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0430\u0439\u043E\u043D/\u0433\u043E\u0440\u043E\u0434">
          \u041D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D\u043E
        </button>
      </li>`+x.map(L=>`
          <li class="req-district-item" data-name="${C((L.name||"").toLowerCase())}">
            <button type="button" class="w-full px-3 py-2 text-left hover:bg-gray-50"
                    data-set="req-district" data-id="${L.id}" data-label="${C(L.name)}">
              ${C(L.name)}
            </button>
          </li>`).join("")}c&&c.addEventListener("click",a=>{t.value||(a.preventDefault(),E&&(E.classList.remove("hidden"),setTimeout(()=>E.classList.add("hidden"),2500)),_("reqDistrictMenu"))}),w&&w.addEventListener("input",()=>{let a=w.value.trim().toLowerCase();b.querySelectorAll(".req-district-item").forEach(r=>{let m=r.dataset.name||"";r.style.display=m.includes(a)?"":"none"})});function R(){return Array.from(i.selectedOptions).map(a=>a.value)}function Y(){if(!v)return;let a=new Set(R().map(String));v.querySelectorAll("input[data-dir-id]").forEach(r=>{let m=r.getAttribute("data-dir-id");r.checked=a.has(String(m))})}function z(a){let r=new Set(a.map(String));Array.from(i.options).forEach(m=>{m.selected=r.has(m.value)}),i.dispatchEvent(new Event("change",{bubbles:!0})),P(),$(),Y()}function $(){let a=R();if(!a.length){g.textContent="\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u044F";return}g.textContent=`\u0412\u044B\u0431\u0440\u0430\u043D\u043E: ${a.length}`}function P(){d.innerHTML="",Array.from(i.selectedOptions).map(r=>({id:r.value,title:r.textContent})).forEach(r=>{let m=document.createElement("button");m.type="button",m.className="inline-flex items-center gap-2 rounded-full border border-blue-200 bg-blue-50 px-3 py-1 text-sm text-blue-800 hover:bg-blue-100",m.innerHTML=`<span>${C(r.title)}</span><span class="text-blue-600">\u2715</span>`,m.addEventListener("click",()=>{let y=R().filter(x=>x!==String(r.id));z(y)}),d.appendChild(m)})}function ee(a){let r=new Set(R());i.innerHTML="",a.forEach(f=>{let L=document.createElement("option");L.value=String(f.id),L.textContent=f.title,i.appendChild(L)});let m=new Set(a.map(f=>String(f.id)));if(Array.from(r).filter(f=>m.has(String(f))).forEach(f=>{let L=Array.from(i.options).find(M=>M.value===String(f));L&&(L.selected=!0)}),!a.length){v.innerHTML='<li class="px-3 py-2 text-gray-500">\u041D\u0435\u0442 \u043D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0439</li>',P(),$(),Y();return}let x=new Set(R());v.innerHTML=a.map(f=>`
        <li class="direction-item" data-name="${C((f.title||"").toLowerCase())}">
          <label class="flex items-center gap-3 px-3 py-2 hover:bg-gray-50 cursor-pointer">
            <input type="checkbox" class="h-4 w-4" data-dir-id="${f.id}" ${x.has(String(f.id))?"checked":""}>
            <span class="text-sm text-gray-800">${C(f.title)}</span>
          </label>
        </li>`).join(""),P(),$()}async function N(a){if(!a){h.disabled=!0,v.innerHTML='<li class="px-3 py-2 text-gray-500">\u0421\u043D\u0430\u0447\u0430\u043B\u0430 \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044E</li>',i.innerHTML="",P(),$();return}h.disabled=!1,l&&l.classList.add("hidden"),v.innerHTML='<li class="px-3 py-2 text-gray-500">\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430...</li>';let r=`${O}?category=${encodeURIComponent(a)}`,y=await(await fetch(r,{headers:{"X-Requested-With":"XMLHttpRequest"}})).json();ee(y.results||[])}h&&h.addEventListener("click",a=>{if(h.disabled){a.preventDefault(),l&&(l.classList.remove("hidden"),setTimeout(()=>l.classList.add("hidden"),2500)),S.classList.add("hidden");return}S.classList.toggle("hidden")}),D&&D.addEventListener("input",()=>{let a=D.value.trim().toLowerCase();v.querySelectorAll(".direction-item").forEach(r=>{let m=r.dataset.name||"";r.style.display=m.includes(a)?"":"none"})}),u&&u.addEventListener("click",()=>z([])),q&&q.addEventListener("click",()=>S.classList.add("hidden")),document.addEventListener("click",a=>{let r=a.target.closest("input[data-dir-id]");if(r){let m=r.getAttribute("data-dir-id"),y=new Set(R());r.checked?y.add(String(m)):y.delete(String(m)),z(Array.from(y));return}}),document.addEventListener("click",async a=>{let r=a.target.closest("button[data-set]");if(!r)return;let m=r.dataset.set,y=r.dataset.id||"",x=r.dataset.label||"";if(m==="req-region"){t.value=y,o&&(o.textContent=x||"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0435\u0433\u0438\u043E\u043D"),s.value="",p&&(p.textContent="\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0430\u0439\u043E\u043D/\u0433\u043E\u0440\u043E\u0434"),await k(y),t.dispatchEvent(new Event("change",{bubbles:!0})),_("reqRegionMenu");return}if(m==="req-district"){if(y&&!Array.from(s.options).some(f=>f.value===String(y))){let f=document.createElement("option");f.value=String(y),f.textContent=x,s.appendChild(f)}s.value=String(y),p&&(p.textContent=x||"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0430\u0439\u043E\u043D/\u0433\u043E\u0440\u043E\u0434"),s.dispatchEvent(new Event("change",{bubbles:!0})),_("reqDistrictMenu");return}if(m==="req-category"){n.value=y,B&&(B.textContent=x||"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044E"),n.dispatchEvent(new Event("change",{bubbles:!0})),_("reqCategoryMenu"),await N(y);return}}),document.addEventListener("click",a=>{!a.target.closest("#reqDirectionsMenu")&&!a.target.closest("#reqDirectionsBtn")&&S?.classList.add("hidden")}),t.value&&k(t.value),n.value?N(n.value):N("")}function Q(){let e=document.getElementById("attachments-container"),n=document.getElementById("add-attachment");if(!e||!n)return;function t(o){o.addEventListener("click",()=>{o.closest(".flex")?.remove(),s()})}function s(){let o=e.querySelectorAll(".flex");if(!o.length)return;let c=o[0].querySelector(".remove-attachment");c&&(o.length===1?c.classList.add("hidden"):c.classList.remove("hidden"))}let i=e.querySelector(".remove-attachment");i&&t(i),n.addEventListener("click",()=>{let o=document.createElement("div");o.className="flex gap-2";let c=document.createElement("input");c.type="file",c.name="attachments",c.accept=".pdf,.doc,.docx,.xls,.xlsx",c.className="block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer p-2 bg-gray-50";let p=document.createElement("button");p.type="button",p.className="remove-attachment shrink-0 rounded-lg border border-gray-300 bg-white px-3 text-sm hover:bg-gray-50",p.textContent="\u2715",t(p),o.appendChild(c),o.appendChild(p),e.appendChild(o),s()}),s()}function ue(){K(),G(),F(),U(),X(),j(),V(),Q()}document.addEventListener("DOMContentLoaded",ue);document.body.addEventListener("htmx:afterSwap",()=>{F(),U(),X(),j(),V(),Q()});})();
